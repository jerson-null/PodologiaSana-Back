# render.yaml

services:
  # --- 1. CONFIGURACIÃ“N DE LA BASE DE DATOS MYSQL (Servicio Privado) ---
  - type: pserv # Private Service (no accesible desde internet)
    name: mysql-db
    env: docker
    dockerContext: .
    # imagen oficial de MySQL
    image: mysql/mysql-server:8.0
    plan: starter # Plan bÃ¡sico de inicio
    
    # credenciales
    envVars:
      - key: MYSQL_ROOT_PASSWORD
        value: adminrender
      - key: MYSQL_DATABASE
        value: podologiasana
      - key: MYSQL_USER
        value: podologiasana
      - key: MYSQL_PASSWORD
        value: adminrender
        
    # ðŸ’¾ ConfiguraciÃ³n ESENCIAL: Disco persistente para que los datos no se pierdan
    disk:
      name: mysql-data
      mountPath: /var/lib/mysql # Directorio estÃ¡ndar de datos de MySQL
      sizeGB: 1 # TamaÃ±o inicial (ajusta si necesitas mÃ¡s)
    
    port: 3306

    # --- 2. CONFIGURACIÃ“N DE TU BACKEND (Servicio Web) ---
  - type: web # Web Service (accesible desde internet)
    name: mi-backend
    env: node 
    # repositorio
    repo: https://github.com/jerson-null/PodologiaSana-Back
    region: oregon
    
    # instalar dependencias y levantar el servidor
    buildCommand: npm install
    startCommand: node server.js
    
    # ðŸ”— Variables para la conexiÃ³n a MySQL (Â¡Usando el nombre interno del servicio!)
    envVars:
      - key: DB_HOST
        value: mysql-db     # <-- Nombre del servicio de BD (del paso 1)
      - key: DB_PORT
        value: 3306
      - key: DB_USER
        value: podologiasana
      - key: DB_PASSWORD
        value: adminrender
      - key: DB_NAME
        value: podologiasana
    
    port: 10000 # El puerto que escucha tu backend